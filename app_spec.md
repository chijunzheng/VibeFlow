# App Specification: VibeFlow (Gemini 3 Local Edition)

### Project Overview

**Project Name:** VibeFlow Studio
**Description:** A local-first songwriting environment that uses Gemini 3’s advanced reasoning to move beyond generic rhymes. It acts as a "Co-Writer" that understands sensory vibes, rhythmic prosody, and phonetic structure.
**Key Value Proposition:** Uses Gemini 3 Flash for rapid brainstorming and Gemini 3 Pro (with High Thinking levels) for nuanced, poetic drafting. It eliminates "AI-sounding" lyrics through a multi-step agentic workflow.

### Technology Stack

**Frontend**

* **Framework:** Next.js 14 (App Router)
* **Styling:** Tailwind CSS + **Glassmorphism** (Modern 2026 aesthetic)
* **Icons:** Lucide-react

**Backend**

* **Language:** Python 3.10+ (FastAPI)
* **AI SDK:** `google-genai` (Official Google SDK for Gemini 3)
* **Database:** SQLite (File: `storage/vibeflow.db`)

---

### Phase 1: Gemini 3 Intelligence Layer

Instead of simple prompts, the app uses **"Thinking Levels"** and **"Thought Signatures"** to ensure the lyrics are high-quality.

| Agent Role | Model Used | Thinking Level | Purpose |
| --- | --- | --- | --- |
| **The Sensory Scout** | Gemini 3 Flash | Low | Rapidly expands 1 word into a "Vibe Cloud" (sights, sounds, smells). |
| **The Architect** | Gemini 3 Pro | Medium | Defines the song structure and rhyme scheme (e.g., AABB, Internal Rhyme). |
| **The Ghostwriter** | Gemini 3 Pro | **High** | Writes the actual lyrics using the Vibe Cloud. Deep reasoning prevents clichés. |

---

### Phase 2: Core Features (Local-First)

**1. The Sensory Cloud (Vibe Engine)**

* **Input:** User enters "Rain".
* **Action:** Gemini 3 Flash generates 5 sensory anchors: *Petrichor, cold glass, blurred brake lights, static on the radio, heavy wool.*
* **Result:** These anchors are fed into the next step to ensure the lyrics are "concrete" rather than "abstract."

**2. Rhythmic "Pro" Editor**

* **Syllable Tracking:** Uses a local Python utility (`syllapy` + Regex) to show real-time syllable counts per line.
* **Gemini Stress Markers:** Gemini 3 marks stressed syllables in **bold** to help the user understand the "flow" or "groove" of the line.
* *Example:* I **walked** down **emp**ty **streets** (7)

**3. Anti-Cliché Filter**

* The "Ghostwriter" agent is strictly instructed to avoid "AI-isms" (e.g., "shimmering," "tapestry," "soul's embrace"). It favors conversational, raw, and modern language.

---

### Phase 3: UI Design (Minimalist 2026)

Since it's local, the UI focuses on "Flow" and "Focus."

**Main Layout Structure:**

* **Glassmorphic Surfaces:** Semi-transparent panels with a subtle blur effect, using a deep slate and violet color palette.
* **The "Thinking" Indicator:** A subtle pulse animation that appears when Gemini 3 is in "High Thinking" mode, signaling deep creative work is happening.
* **Auto-Save Indicator:** A small "Saved to Local" dot in the corner—no "Save" button needed.

---

### Database Schema (SQLite)

**Table: `songs**`
| Column | Type | Description |
| :--- | :--- | :--- |
| `id` | INTEGER (PK) | Unique ID |
| `title` | TEXT | Song name |
| `vibe_cloud` | TEXT (JSON) | The sensory anchors generated by Gemini |
| `content` | TEXT (JSON) | The lyrics, structure, and syllable counts |
| `thought_sig` | TEXT | The **Gemini 3 Thought Signature** (to resume the creative session) |

---

### Implementation Steps (Next 48 Hours)

1. **Init API:** Set up the `google-genai` client. Create two helper functions: `get_vibe_cloud()` (Flash) and `write_section()` (Pro).
2. **Local DB:** Create the SQLite file and write a simple `save_song` function in FastAPI.
3. **The Sidebar:** Build a React component that lists local `.db` entries so you can switch between song projects instantly.
4. **The Generation Button:** Implement **Streamed Responses**. Use FastAPI's `StreamingResponse` so you can see Gemini "writing" the lyrics word-by-word.

